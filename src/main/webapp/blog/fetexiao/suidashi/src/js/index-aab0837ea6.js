!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){i(30)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var n=i(31),s=i(32).start_resources,o=i(33);qc.game.onStart=function(){n.preload(s,function(){if(SG.stoneGame.gameCanBegin){var e=new o;return qc.director.runScene(e),SG.stoneGame.gameHasBegin=!0,void setTimeout(function(){SG.stoneGame.resizeToWindow()},200)}SG.stoneGame.gameCanBegin=!0})},qc.game.run(),window.SG=window.SG||{},SG.StoneGame=function(){this.addListener()},SG.StoneGame.prototype={onGameOver:function(){qc.log("gameOver")},onGameWinOne:function(){qc.log("winOne")},winMoney:100,gameCanBegin:!1,gameHasBegin:!1,isApp:!1,init:function(e){e=e||{},this.onGameOver=e.onGameOver||this.onGameOver,this.onGameWinOne=e.onGameWinOne||this.onGameWinOne},setWinMoney:function(e){this.winMoney=e},gameStop:function(){this.gameHasBegin&&(qc.director.runScene(new GameOverScene),this.onGameOver())},restart:function(){if(this.winMoney=100,this.isApp=this.is_app(),this.gameCanBegin){var e=new o;qc.director.runScene(e),this.gameHasBegin=!0;var t=this;setTimeout(function(){t.resizeToWindow()},200)}else this.gameCanBegin=!0},is_app:function(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("qunar")!=-1},addListener:function(){window.removeEventListener("resize",qc.resizeCall,!1);var e=this.resizeToWindow;e(),window.addEventListener("resize",e,!1)},resizeToWindow:function(){var e,t,i=qc.director.getWinSize(),n=i.width,s=i.height,o=qc.container,r=(qc._canvas,o.style),a=document.getElementsByClassName("horizontal_center")[0],h=window.innerWidth,c=window.innerHeight-44,l=n/s,u=h/c;l>u?(e=h,t=h/n*s):(t=c,e=c/s*n),r.width=(e||480)+"px",r.height=(t||320)+"px",a.style.width="100%",a.style.height=c+"px",a.style.marginTop="44px"}},SG.stoneGame=new SG.StoneGame,function(){SG.stoneGame.restart()}()},function(e,t){var i=qc.Scene.extend({_interval:null,_length:0,_count:0,_label:null,_className:"LoaderScene",timer:null,init:function(){var e=this,t=40,i=qc.director.getWinSize(),n=qc.p(i.width/2-100,i.height/2),s=e._label=qc.Label.create("Loading... 0%","Arial",t);return s.setPosition(n),s.setColor(qc.color(180,180,180)),this.addChild(this._label,10),!0},_initStage:function(e,t){var i=this,n=i._texture2d=new qc.Texture2D;n.initWithElement(e),n.handleLoadedTexture();var s=i._logo=qc.Sprite.create(n);s.setScale(qc.contentScaleFactor()),s.x=t.x,s.y=t.y,i._bgLayer.addChild(s,10)},onEnter:function(){var e=this;qc.Node.prototype.onEnter.call(e),e._startLoading()},onExit:function(){qc.Node.prototype.onExit.call(this),this.timer&&clearInterval(this.timer)},initWithResources:function(e,t){"string"==typeof e&&(e=[e]),this.resources=e||[],this.cb=t},_startLoading:function(){var e=this,t=e.resources;e._length=t.length,e._count=0,qc.loader.load(t,function(t,i){e._count=i},function(){e.cb&&e.cb()}),this.timer=setInterval(function(){e._updatePercent()},.1)},_updatePercent:function(){var e=this,t=e._count,i=e._length,n=t/i*100|0;n=Math.min(n,100),e._label.setString("Loading... "+n+"%")},isLoaded:function(){return this._count==this._length}});i.preload=function(e,t){return this.loaderScene||(this.loaderScene=new i,this.loaderScene.init()),this.loaderScene.initWithResources(e,t),qc.director.runScene(this.loaderScene),this.loaderScene},e.exports=i},function(e,t){var i={baozha:"xksds_band.png",title:"xksds_head_title.png",peopleHead:"xksds_ren01.png",headbtn:"xksds_head_btn.png",headbtnleft:"xksds_head_kai1.png",headbtnrigth:"xksds_head_kai2.png",people:"xksds_ren02.png",hand2:"xksds_human_hand.png",hand:"xksds_human_hand2.png",hitpeople:"xksds_sleep_nosuccess.png",stone:"xksds_Level_3.png",stone1:"xksds_Level_3_1.png",stone2:"xksds_Level_3_2.png",stoneSui:"xksds_Level_3_3.png",peopleFailed:"xksds_ren-over04.png",peopleGood1:"xksds_ren-win03.png",sleeperSuccess:"xksds_sleep_success.png",sleeperFailed:"xksds_sleep_duan.png",shootBg:"xksds_shootbg.png",shootArea:"xksds_shootarea.png",shooter:"xksds_shooter.png",suibtn:"xksds_suibtn.png",suibtnpress:"xksds_suibtnpress.png",gameover:"xksds_gameover.png"},n=[],s=window.staticImage||"res/img/";for(var o in i)i[o]=s+i[o],n.push(i[o]);e.exports={res:i,start_resources:n}},function(e,t,i){window.STONE_GAME_STATE={GAMEBEGIN:0,GAMESUCCESS:1,GAMEGOOD:2,GAMEFAILD:3};var n=i(34),s=i(32).res,o=i(35),r=i(36),a=i(38),h=i(39);window.GameLayer=qc.Layer.extend({winSize:null,middlePos:null,people:null,hitPeople:null,shootModel:null,suiBtn:null,gameState:STONE_GAME_STATE.GAMEBEGIN,frontLayer:null,maxFrontLayer:null,totalMoney:0,totalNum:10,winNum:0,moneyLabel:null,chanceLaber:null,init:function(){this._super(),this.winSize=qc.director.getWinSize(),this.middlePos=qc.p(this.winSize.width/2,this.winSize.height/2),this.totalNum=10,this.totalMoney=0,this.winNum=0,this.initGameState(),this.initBg(),this.initLabel(),this.frontLayer=qc.Layer.create(),this.addChild(this.frontLayer),this.maxFrontLayer=qc.Layer.create(),this.addChild(this.maxFrontLayer),this.initTitle(),this.initPeople(),this.initHitPeople(),this.initShootModel(),this.initSuiBtn(),this.addListener()},initGameState:function(){this.gameState=STONE_GAME_STATE.GAMEBEGIN},initTitle:function(){var e=qc.Sprite.create(s.title);this.frontLayer.addChild(e),e.setPosition(qc.p(this.middlePos.x,this.middlePos.y+355))},initBg:function(){var e=n.create(qc.color(223,222,224));this.addChild(e)},initLabel:function(){var e=SG.stoneGame.isApp?"本轮获得:0元":"成功碎石:0块",t=this.moneyLabel=qc.Label.create(e,null,36);t.setColor(qc.color(80,64,64)),this.addChild(t),t.setPosition(qc.p(30,this.winSize.height-40));var i=this.chanceLaber=qc.Label.create("剩余机会:10次",null,36);i.setColor(qc.color(80,64,64)),this.addChild(i),i.setPosition(qc.p(370,this.winSize.height-40))},initPeople:function(){var e=this.people=new o;this.frontLayer.addChild(e),e.setPosition(qc.p(this.middlePos.x-15,this.middlePos.y-50))},initHitPeople:function(){var e=this.hitPeople=new r;this.frontLayer.addChild(e),e.setPosition(qc.p(this.middlePos.x,this.middlePos.y-150))},initShootModel:function(){this.shootModel=new a,this.frontLayer.addChild(this.shootModel),this.shootModel.setPosition(qc.p(this.middlePos.x+250,this.middlePos.y))},initSuiBtn:function(){this.suiBtn=new h,this.addChild(this.suiBtn),this.suiBtn.setPosition(qc.p(this.middlePos.x,100))},addListener:function(){var e=this;qc.EventManager.addListener({event:qc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan.bind(e),onTouchMoved:null,onTouchEnded:this.onTouchEnded.bind(e)},this)},onTouchBegan:function(e,t){if(this.gameState==STONE_GAME_STATE.GAMEBEGIN){var i=e.getLocation();this.pressSuiBtn(i)}},onTouchEnded:function(e,t){if(this.gameState==STONE_GAME_STATE.GAMEBEGIN){var i=e.getLocation();this.upSuiBtn(i)}},pressSuiBtn:function(e){this.checkBtnSui(e)&&this.suiBtn.press()},checkBtnSui:function(e){var t=this.suiBtn.getPosition();return e.x>t.x-98&&e.x<t.x+98&&e.y>t.y-55&&e.y<t.y+55},upSuiBtn:function(e){this.checkBtnSui(e)&&this.suiBtn.isSelect&&(this.gameState=this.shootModel.stop(),this.handleResult()),this.suiBtn.isSelect&&this.suiBtn.up()},handleResult:function(){switch(this.gameState){case STONE_GAME_STATE.GAMEBEGIN:this.reset();break;case STONE_GAME_STATE.GAMESUCCESS:this.waveTheWorld(20),this.executSuccess();break;case STONE_GAME_STATE.GAMEGOOD:this.waveTheWorld(40),this.executGood();break;case STONE_GAME_STATE.GAMEFAILD:this.waveTheWorld(20),this.executFaild()}this.changeNum()},changeNum:function(){if(this.totalNum--,this.chanceLaber.setString("剩余机会:"+this.totalNum+"次"),this.totalNum>0){var e=this;setTimeout(function(){e.reset()},2e3)}else setTimeout(function(){qc.director.runScene(new GameOverScene),SG.stoneGame.onGameOver()},2e3)},waveTheWorld:function(e){var t=qc.MoveTo.create(.1,qc.p(0,e)),i=qc.MoveTo.create(.1,qc.p(0,0)),n=qc.Sequence.create([t,i]),s=qc.RepeatForever.create(n,4);this.frontLayer.runAction(s)},executSuccess:function(){var e=this;this.people.hit(function(){e.people.hitSuccess(),e.hitPeople.hitSuccess()}),SG.stoneGame.onGameWinOne(),this.winNum++,this.addMoney(SG.stoneGame.winMoney)},executFaild:function(){var e=this;this.people.hit(function(){e.people.hitFailed(),e.hitPeople.hitFailed()}),this.addMoney(0)},executGood:function(){var e=this;this.people.hit(function(){e.people.hitGood(),e.hitPeople.hitSuccess()}),SG.stoneGame.onGameWinOne(),this.winNum++,this.addMoney(SG.stoneGame.winMoney)},addMoney:function(e){var t,i=SG.stoneGame.isApp;i||0==e?(this.totalMoney+=e,t=0==e?"石头没碎！":"+"+e/100+"元"):t="碎成功！";var n=qc.Label.create(t,null,80);n.setColor(qc.color(197,32,32)),this.maxFrontLayer.addChild(n),n.setPosition(qc.p(this.middlePos.x-40*t.length,this.middlePos.y+100));var s=qc.MoveBy.create(.5,qc.p(0,100)),o=qc.CallFunc.create(function(){n.removeFromParent()}),r=qc.Sequence.create([s,o]);n.runAction(r),i?this.moneyLabel.setString("本轮获得:"+this.totalMoney/100+"元"):this.moneyLabel.setString("成功碎石:"+this.winNum+"块")},reset:function(){this.people.reset(),this.hitPeople.reset(),this.shootModel.beginMove(),this.gameState=STONE_GAME_STATE.GAMEBEGIN}});var c=qc.Scene.extend({onEnter:function(){this._super();var e=new GameLayer;e.init(),this.addChild(e)}});e.exports=c},function(e,t){var i=qc.Layer.extend({_color:null,_fillColorStr:null,initWithColor:function(e){this._color=e,this.setColor(e)},setColor:function(e){this._fillColorStr="rgba("+e.r+","+e.g+","+e.b+",1)"},draw:function(e){if(this._color){e.save();var t=this.getPosition(),i=qc.rect(t.x,qc._canvas.height-t.y,qc._canvas.width,qc._canvas.height);return e.fillStyle=this._fillColorStr,e.fillRect(-i.x,-i.y,i.width,i.height),e.restore(),!0}}});i.create=function(e){var t=new i;return t.initWithColor(e),t},e.exports=i},function(e,t,i){var n=i(32).res,s=qc.Layer.extend({people:null,normalFrame:null,successFrame:null,failedFrame:null,goodFrame1:null,hand:null,handFrames:[],ctor:function(){this._super(),this.init()},init:function(){this._super(),this.initPeople(),this.initHandFrame(),this.initHand()},initPeople:function(){var e=this.people=qc.Sprite.create(n.people);this.normalFrame=qc.SpriteFrame.createWithFile(n.people),this.successFrame=qc.SpriteFrame.createWithFile(n.peopleGood1),this.failedFrame=qc.SpriteFrame.createWithFile(n.peopleFailed),this.goodFrame1=qc.SpriteFrame.createWithFile(n.peopleGood1),this.addChild(e),this.chuanQiAction(e)},initHandFrame:function(){var e=qc.SpriteFrame.createWithFile(n.hand);this.handFrames.push(e),e=qc.SpriteFrame.createWithFile(n.hand2),this.handFrames.push(e)},initHand:function(){this.hand||(this.hand=qc.Sprite.create(n.hand),this.addChild(this.hand));var e=this.hand;e.setSpriteFrame(this.handFrames[0]);var t=this.people.getPosition();e.setPosition(t.x-20,t.y+80),e.setAnchorPoint(qc.p(.9,.3)),this.huishouAction(e)},huishouAction:function(e){var t=qc.RotateTo.create(.4,-20),i=qc.RotateTo.create(.4,10),n=qc.Sequence.create([t,i]),s=qc.RepeatForever.create(n);e.runAction(s)},chuanQiAction:function(e){var t=qc.ScaleTo.create(.4,1,1.02),i=qc.ScaleTo.create(.4,1),n=qc.Sequence.create([t,i]),s=qc.RepeatForever.create(n);e.runAction(s)},hit:function(e){this.hand.stopAllActions();var t=this,i=qc.RotateTo.create(.1,-40),n=qc.CallFunc.create(function(){t.hand.setSpriteFrame(t.handFrames[1]),t.hand.setAnchorPoint(qc.p(.7,.9));var e=t.people.getPosition();t.hand.setPosition(e.x-10,e.y+102),t.hand.setRotation(20)}),s=qc.RotateTo.create(.05,0),o=qc.CallFunc.create(function(){t.people.stopAllActions(),e()}),r=qc.Sequence.create([i,n,s,o]);this.hand.runAction(r)},hitFailed:function(){this.people.setSpriteFrame(this.failedFrame)},hitSuccess:function(){this.hand.removeFromParent(),this.hand=null,this.people.setSpriteFrame(this.successFrame)},hitGood:function(){this.hand.removeFromParent(),this.hand=null,this.people.setSpriteFrame(this.goodFrame1)},reset:function(){this.initHand(),this.people.stopAllActions(),this.people.setSpriteFrame(this.normalFrame),this.chuanQiAction(this.people)}});e.exports=s},function(e,t,i){var n=i(32).res,s=i(37),o=qc.Layer.extend({people:null,eyes:null,stone:null,normalFrame:null,successFrame:null,failedFrame:null,ctor:function(){this._super(),this.init()},init:function(){this.initPeople(),this.initStone()},initPeople:function(){var e=this.people=qc.Sprite.create(n.hitpeople);this.normalFrame=qc.SpriteFrame.createWithFile(n.hitpeople),this.successFrame=qc.SpriteFrame.createWithFile(n.sleeperSuccess),this.failedFrame=qc.SpriteFrame.createWithFile(n.sleeperFailed),this.addChild(e)},initStone:function(){var e=this.stone=new s;this.addChild(e),e.setScale(.8),e.setPosition(qc.p(0,50))},hitSuccess:function(){this.runToFrame(this.successFrame),this.stone.hitSuccess()},hitFailed:function(){this.runToFrame(this.failedFrame),this.stone.hitFailed()},reset:function(){this.people.setSpriteFrame(this.normalFrame),this.stone.reset()},runToFrame:function(e){this.people.setSpriteFrame(e)}});e.exports=o},function(e,t,i){var n=i(32).res,s=qc.Layer.extend({stone:null,stone1:null,stone2:null,stoneSui:null,ctor:function(){this._super(),this.init()},init:function(){this._super(),this.initStone()},initStone:function(){var e=this.stone=qc.Sprite.create(n.stone);this.addChild(e)},hitSuccess:function(){this.baozhaAction(),this.stone.removeFromParent(),this.stone=null;var e,t,i;e=this.stone1=qc.Sprite.create(n.stone1),t=this.stone2=qc.Sprite.create(n.stone2),i=this.stoneSui=qc.Sprite.create(n.stoneSui),this.addChild(e),this.addChild(t),e.setPosition(qc.p(-20,0)),t.setPosition(qc.p(20,0));var s=this,o=qc.MoveBy.create(.05,qc.p(-60,0)),r=qc.MoveBy.create(.05,qc.p(60,0)),a=qc.CallFunc.create(function(){s.addChild(i),i.setPosition(qc.p(0,-40))}),h=qc.Sequence.create([o,a]);e.runAction(h),t.runAction(r)},hitFailed:function(){this.baozhaAction();var e=qc.MoveTo.create(.1,qc.p(150,-180));this.stone.runAction(e)},baozhaAction:function(){var e=qc.Sprite.create(n.baozha);this.addChild(e,1e3),e.setPosition(this.stone.getPosition()),e.setScale(.1);var t=qc.ScaleTo.create(.1,.8),i=qc.CallFunc.create(function(){e.removeFromParent()}),s=qc.Sequence.create([t,i]);e.runAction(s)},reset:function(){this.stone&&(this.stone.stopAllActions(),this.stone.removeFromParent()),this.stone1&&(this.stone1.stopAllActions(),this.stone1.removeFromParent()),this.stone2&&(this.stone2.stopAllActions(),this.stone2.removeFromParent()),this.stoneSui&&this.stoneSui.removeFromParent(),this.stone=this.stone1=this.stone2=this.stoneSui=null,this.initStone()}});e.exports=s},function(e,t,i){var n=i(32).res,s=qc.Layer.extend({bgSprite:null,shootArea:null,shooter:null,speed:null,topPos:null,bottomPos:null,allHeight:0,goodR:10,successR:0,ctor:function(e){this._super(),this.speed=e||400,this.init()},init:function(){this.initBg(),this.initHitArea(),this.initTransFlag(),this.beginMove()},initBg:function(){this.bgSprite=qc.Sprite.create(n.shootBg),this.addChild(this.bgSprite);var e=this.bgSprite.getTextureRect();this.topPos=qc.p(0,e.height/2-4),this.bottomPos=qc.p(0,-e.height/2+4),this.allHeight=e.height},initHitArea:function(){this.shootArea=qc.Sprite.create(n.shootArea),this.addChild(this.shootArea);var e=this.shootArea.getTextureRect();this.successR=e.height/2},initTransFlag:function(){this.shooter=qc.Sprite.create(n.shooter),this.addChild(this.shooter)},beginMove:function(e){this.speed=e||Math.floor(200*Math.random()+200);var t=this.allHeight/this.speed,i=qc.MoveTo.create(t,this.topPos),n=qc.MoveTo.create(t,this.bottomPos),s=qc.Sequence.create([i,n]),o=qc.RepeatForever.create(s);this.shooter.setPosition(this.bottomPos),this.shooter.runAction(o)},stop:function(){this.shooter.stopAllActions();var e=this.shooter.getPosition(),t=this.shootArea.getPosition(),i=Math.abs(e.y-t.y);return i<this.goodR?STONE_GAME_STATE.GAMEGOOD:i<this.successR?STONE_GAME_STATE.GAMESUCCESS:STONE_GAME_STATE.GAMEFAILD}});e.exports=s},function(e,t,i){var n=i(32).res,s=qc.Layer.extend({mSprite:null,btnFrames:[],isSelect:!1,ctor:function(){this._super(),this.init()},init:function(){this._super(),this.initFrames(),this.initMSprite()},initMSprite:function(){this.mSprite=qc.Sprite.create(n.suibtn),this.addChild(this.mSprite)},initFrames:function(){var e=qc.SpriteFrame.createWithFile(n.suibtn);this.btnFrames.push(e),e=qc.SpriteFrame.createWithFile(n.suibtnpress),this.btnFrames.push(e)},press:function(){this.mSprite.setSpriteFrame(this.btnFrames[1]),this.isSelect=!0},up:function(){this.mSprite.setSpriteFrame(this.btnFrames[0]),this.isSelect=!1},isContain:function(e){var e=this.translateToLayer(e);return this.mSprite.isContain(e)}});e.exports=s}]);